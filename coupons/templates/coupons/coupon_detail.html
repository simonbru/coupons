{% extends 'base.html' %}

{% load bootstrap3 humanize %}

{% block content %}
  <h1>
    {{ coupon.title }}
    <small>{{ coupon.price }} Fr.</small>
  </h1>

  {% if coupon.disabled %}
    <h2 class="text-danger">Note: Ce bon ne semble plus fonctionner.</h2>
  {% endif %}
  <div class="barcode-container col-xs-12 col-sm-7 col-md-6">
    <img src="{% url 'coupon_barcode' coupon.pk %}" class="barcode-image">
  </div>

  <div>
    <h3>Derni√®res notes</h3>
    {% for place, comment in coupon.last_comment_per_place.items %}
      <div>
        {% if comment.does_coupon_work %}
          {% bootstrap_icon 'ok-circle' extra_classes='text-success' %}
        {% else %}
          {% bootstrap_icon 'remove-circle' extra_classes='text-danger' %}
        {% endif %}
        {{ place }} -
        <em>{{ comment.created_at|naturaltime }}</em>
      </div>
    {% empty %}
      <em>Aucune</em>
    {% endfor %}
  </div>

  <div>
    <h3>Notez ce bon</h3>
    <form method="post" class="comment-form" novalidate>
      {% csrf_token %}

      <div data-toggle="buttons" class="form-group">
        {% for radio in comment_form.does_coupon_work %}
          {{ radio }}
        {% endfor %}
      </div>

      <div class="collapse comment-form-details">
        {% bootstrap_field comment_form.restaurant %}
        {% bootstrap_button 'Envoyer' button_type='submit' %}
      </div>
    </form>
  </div>
{% endblock %}
